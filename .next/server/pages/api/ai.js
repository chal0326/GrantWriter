"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/ai";
exports.ids = ["pages/api/ai"];
exports.modules = {

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "@google/generative-ai":
/*!****************************************!*\
  !*** external "@google/generative-ai" ***!
  \****************************************/
/***/ ((module) => {

module.exports = import("@google/generative-ai");;

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fai&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fai.js&middlewareConfigBase64=e30%3D!":
/*!**********************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fai&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fai.js&middlewareConfigBase64=e30%3D! ***!
  \**********************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_ai_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages/api/ai.js */ \"(api)/./pages/api/ai.js\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_pages_api_ai_js__WEBPACK_IMPORTED_MODULE_3__]);\n_pages_api_ai_js__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_ai_js__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_ai_js__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/ai\",\n        pathname: \"/api/ai\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_ai_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRmFpJnByZWZlcnJlZFJlZ2lvbj0mYWJzb2x1dGVQYWdlUGF0aD0uJTJGcGFnZXMlMkZhcGklMkZhaS5qcyZtaWRkbGV3YXJlQ29uZmlnQmFzZTY0PWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDTDtBQUMxRDtBQUM4QztBQUM5QztBQUNBLGlFQUFlLHdFQUFLLENBQUMsNkNBQVEsWUFBWSxFQUFDO0FBQzFDO0FBQ08sZUFBZSx3RUFBSyxDQUFDLDZDQUFRO0FBQ3BDO0FBQ08sd0JBQXdCLGdIQUFtQjtBQUNsRDtBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxZQUFZO0FBQ1osQ0FBQzs7QUFFRCxxQyIsInNvdXJjZXMiOlsid2VicGFjazovL2dyYW50LXdyaXRlci8/ZGJiZSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQYWdlc0FQSVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvcGFnZXMtYXBpL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IGhvaXN0IH0gZnJvbSBcIm5leHQvZGlzdC9idWlsZC90ZW1wbGF0ZXMvaGVscGVyc1wiO1xuLy8gSW1wb3J0IHRoZSB1c2VybGFuZCBjb2RlLlxuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi4vcGFnZXMvYXBpL2FpLmpzXCI7XG4vLyBSZS1leHBvcnQgdGhlIGhhbmRsZXIgKHNob3VsZCBiZSB0aGUgZGVmYXVsdCBleHBvcnQpLlxuZXhwb3J0IGRlZmF1bHQgaG9pc3QodXNlcmxhbmQsIFwiZGVmYXVsdFwiKTtcbi8vIFJlLWV4cG9ydCBjb25maWcuXG5leHBvcnQgY29uc3QgY29uZmlnID0gaG9pc3QodXNlcmxhbmQsIFwiY29uZmlnXCIpO1xuLy8gQ3JlYXRlIGFuZCBleHBvcnQgdGhlIHJvdXRlIG1vZHVsZSB0aGF0IHdpbGwgYmUgY29uc3VtZWQuXG5leHBvcnQgY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgUGFnZXNBUElSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuUEFHRVNfQVBJLFxuICAgICAgICBwYWdlOiBcIi9hcGkvYWlcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9haVwiLFxuICAgICAgICAvLyBUaGUgZm9sbG93aW5nIGFyZW4ndCB1c2VkIGluIHByb2R1Y3Rpb24uXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcIlwiXG4gICAgfSxcbiAgICB1c2VybGFuZFxufSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhZ2VzLWFwaS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fai&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fai.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./pages/api/ai.js":
/*!*************************!*\
  !*** ./pages/api/ai.js ***!
  \*************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _google_generative_ai__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @google/generative-ai */ \"@google/generative-ai\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_google_generative_ai__WEBPACK_IMPORTED_MODULE_0__]);\n_google_generative_ai__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\nconst genAI = new _google_generative_ai__WEBPACK_IMPORTED_MODULE_0__.GoogleGenerativeAI(\"AIzaSyBHu8vw1XvJKGufalwm3iLIuDc2gvh6Tgk\");\nconst CRITIQUE_PROMPT = `You are an expert grant writer who helps to connect small non-profits and startups led by powerful, strong, BIPOC women with financial abundance that allows the grant recipients to do tremendous good in the world.\n\nAnalyze the grant proposal and provide feedback in the following format:\n\n# Section Analysis\nFor each section below, indicate if it needs improvement (YES/NO) and provide specific feedback:\n\n## Opening Hook\nStatus: [YES/NO]\nFeedback: [Your specific feedback here]\n\n## Impact Statement\nStatus: [YES/NO]\nFeedback: [Your specific feedback here]\n\n## Mission Statement\nStatus: [YES/NO]\nFeedback: [Your specific feedback here]\n\n## Goals & Objectives\nStatus: [YES/NO]\nFeedback: [Your specific feedback here]\n\n## Budget Justification\nStatus: [YES/NO]\nFeedback: [Your specific feedback here]\n\nBe specific in your feedback, explaining exactly what isn't working and why.`;\nconst IMPROVEMENT_PROMPT = `Based on the critique provided, generate two distinctly different approaches for improving this section: {section}. \n\nFor context, here is the full draft:\n{content}\n\nFormat your response exactly like this:\n\nOption 1:\n[Complete rewrite with first approach - focus on being direct and impactful]\n\nOption 2:\n[Complete rewrite with second approach - focus on being descriptive and detailed]\n\nMake each option distinctly different in tone and emphasis. Each option should be complete and ready to use.\nEach option should maintain proper formatting and structure.`;\nconst FINAL_REVIEW_PROMPT = `Review this draft holistically and provide actionable feedback. Consider how well it flows and if it presents a compelling narrative.\n\nFormat your response like this:\n\n## Overall Assessment\n[Provide a brief evaluation of the draft's effectiveness and potential impact]\n\n## Key Strengths\n- [Specific strength with explanation]\n- [Specific strength with explanation]\n- [Specific strength with explanation]\n\n## Recommended Improvements\n- [Specific, actionable improvement suggestion]\n- [Specific, actionable improvement suggestion]\n- [Specific, actionable improvement suggestion]\n\n## Final Recommendations\n[Concrete next steps and suggestions for strengthening the proposal further]`;\nconst generationConfig = {\n    temperature: 1,\n    topP: 0.95,\n    topK: 64,\n    maxOutputTokens: 8192\n};\nasync function handler(req, res) {\n    if (req.method !== \"POST\") {\n        return res.status(405).json({\n            error: \"Method not allowed\"\n        });\n    }\n    try {\n        if (false) {}\n        const { action, text, sections } = req.body;\n        if (!text) {\n            return res.status(400).json({\n                error: \"Text content is required\"\n            });\n        }\n        // Clean the text content\n        const cleanText = text.replace(/`/g, \"\").trim();\n        if (!cleanText) {\n            return res.status(400).json({\n                error: \"Text content is empty after cleaning\"\n            });\n        }\n        const model = genAI.getGenerativeModel({\n            model: \"gemini-pro\",\n            generationConfig\n        });\n        let prompt;\n        switch(action){\n            case \"critique\":\n                prompt = CRITIQUE_PROMPT;\n                break;\n            case \"improve\":\n                if (!sections || sections.length === 0) {\n                    return res.status(400).json({\n                        error: \"Sections are required for improvements\"\n                    });\n                }\n                // Handle multiple sections at once\n                const improvements = {};\n                for (const section of sections){\n                    const sectionPrompt = IMPROVEMENT_PROMPT.replace(\"{section}\", section).replace(\"{content}\", cleanText);\n                    const result = await model.generateContent(sectionPrompt);\n                    const response = await result.response;\n                    const text = response.text();\n                    // Parse the two options\n                    const parts = text.split(/Option [12]:/);\n                    if (parts.length < 3) {\n                        console.error(\"Invalid improvement format for section:\", section);\n                        continue;\n                    }\n                    improvements[section] = [\n                        parts[1].trim(),\n                        parts[2].trim()\n                    ];\n                }\n                return res.status(200).json({\n                    improvements\n                });\n            case \"final\":\n                prompt = FINAL_REVIEW_PROMPT;\n                break;\n            default:\n                return res.status(400).json({\n                    error: \"Invalid action\"\n                });\n        }\n        console.log(`Processing ${action} request...`);\n        const result = await model.generateContent(prompt + \"\\n\\n\" + cleanText);\n        const response = await result.response;\n        const responseText = response.text();\n        if (!responseText || responseText.trim().length === 0) {\n            throw new Error(\"Empty response from AI\");\n        }\n        if (action === \"critique\") {\n            const sections = {};\n            let currentSection = null;\n            let currentStatus = null;\n            let currentFeedback = [];\n            const lines = responseText.split(\"\\n\");\n            for (let line of lines){\n                line = line.trim();\n                if (!line) continue;\n                if (line.startsWith(\"## \")) {\n                    if (currentSection) {\n                        const key = currentSection.toLowerCase().replace(/[^a-z0-9]+/g, \"_\");\n                        sections[key] = {\n                            id: key,\n                            name: currentSection,\n                            needsWork: currentStatus === \"YES\",\n                            feedback: currentFeedback.join(\"\\n\").trim(),\n                            text: \"\" // Will be populated from the draft\n                        };\n                    }\n                    currentSection = line.replace(\"## \", \"\").trim();\n                    currentStatus = null;\n                    currentFeedback = [];\n                } else if (line.startsWith(\"Status:\")) {\n                    currentStatus = line.replace(\"Status:\", \"\").trim();\n                } else if (line.startsWith(\"Feedback:\")) {\n                    currentFeedback = [\n                        line.replace(\"Feedback:\", \"\").trim()\n                    ];\n                } else if (currentFeedback) {\n                    currentFeedback.push(line);\n                }\n            }\n            // Save the last section\n            if (currentSection) {\n                const key = currentSection.toLowerCase().replace(/[^a-z0-9]+/g, \"_\");\n                sections[key] = {\n                    id: key,\n                    name: currentSection,\n                    needsWork: currentStatus === \"YES\",\n                    feedback: currentFeedback.join(\"\\n\").trim(),\n                    text: \"\" // Will be populated from the draft\n                };\n            }\n            // Extract section content from the draft\n            let currentDraftSection = null;\n            let currentContent = [];\n            const draftLines = cleanText.split(\"\\n\");\n            for (const line of draftLines){\n                if (line.trim().startsWith(\"## \")) {\n                    if (currentDraftSection) {\n                        const key = currentDraftSection.toLowerCase().replace(/[^a-z0-9]+/g, \"_\");\n                        if (sections[key]) {\n                            sections[key].text = currentContent.join(\"\\n\").trim();\n                        }\n                    }\n                    currentDraftSection = line.replace(/^## /, \"\").trim();\n                    currentContent = [];\n                } else if (currentDraftSection) {\n                    currentContent.push(line);\n                }\n            }\n            // Save the last section content\n            if (currentDraftSection) {\n                const key = currentDraftSection.toLowerCase().replace(/[^a-z0-9]+/g, \"_\");\n                if (sections[key]) {\n                    sections[key].text = currentContent.join(\"\\n\").trim();\n                }\n            }\n            return res.status(200).json({\n                sections: Object.values(sections)\n            });\n        }\n        return res.status(200).json({\n            feedback: responseText\n        });\n    } catch (error) {\n        console.error(\"AI API Error:\", error);\n        return res.status(500).json({\n            error: \"Failed to process with AI\",\n            details: error.message\n        });\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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ZUFBZTtnQkFDckUsSUFBSUgsUUFBUSxDQUFDMEIsSUFBSSxFQUFFO29CQUNqQjFCLFFBQVEsQ0FBQzBCLElBQUksQ0FBQzNCLElBQUksR0FBR29DLGVBQWVILElBQUksQ0FBQyxNQUFNNUIsSUFBSTtnQkFDckQ7WUFDRjtZQUVBLE9BQU9aLElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7Z0JBQUVLLFVBQVVxQyxPQUFPQyxNQUFNLENBQUN0QztZQUFVO1FBQ2xFO1FBRUEsT0FBT1IsSUFBSUUsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztZQUFFb0MsVUFBVVo7UUFBYTtJQUV2RCxFQUFFLE9BQU92QixPQUFPO1FBQ2RxQixRQUFRckIsS0FBSyxDQUFDLGlCQUFpQkE7UUFDL0IsT0FBT0osSUFBSUUsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztZQUMxQkMsT0FBTztZQUNQMkMsU0FBUzNDLE1BQU00QyxPQUFPO1FBQ3hCO0lBQ0Y7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2dyYW50LXdyaXRlci8uL3BhZ2VzL2FwaS9haS5qcz85ZDQ4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEdvb2dsZUdlbmVyYXRpdmVBSSB9IGZyb20gJ0Bnb29nbGUvZ2VuZXJhdGl2ZS1haSc7XG5cbmNvbnN0IGdlbkFJID0gbmV3IEdvb2dsZUdlbmVyYXRpdmVBSShwcm9jZXNzLmVudi5HT09HTEVfQUlfQVBJX0tFWSk7XG5cbmNvbnN0IENSSVRJUVVFX1BST01QVCA9IGBZb3UgYXJlIGFuIGV4cGVydCBncmFudCB3cml0ZXIgd2hvIGhlbHBzIHRvIGNvbm5lY3Qgc21hbGwgbm9uLXByb2ZpdHMgYW5kIHN0YXJ0dXBzIGxlZCBieSBwb3dlcmZ1bCwgc3Ryb25nLCBCSVBPQyB3b21lbiB3aXRoIGZpbmFuY2lhbCBhYnVuZGFuY2UgdGhhdCBhbGxvd3MgdGhlIGdyYW50IHJlY2lwaWVudHMgdG8gZG8gdHJlbWVuZG91cyBnb29kIGluIHRoZSB3b3JsZC5cblxuQW5hbHl6ZSB0aGUgZ3JhbnQgcHJvcG9zYWwgYW5kIHByb3ZpZGUgZmVlZGJhY2sgaW4gdGhlIGZvbGxvd2luZyBmb3JtYXQ6XG5cbiMgU2VjdGlvbiBBbmFseXNpc1xuRm9yIGVhY2ggc2VjdGlvbiBiZWxvdywgaW5kaWNhdGUgaWYgaXQgbmVlZHMgaW1wcm92ZW1lbnQgKFlFUy9OTykgYW5kIHByb3ZpZGUgc3BlY2lmaWMgZmVlZGJhY2s6XG5cbiMjIE9wZW5pbmcgSG9va1xuU3RhdHVzOiBbWUVTL05PXVxuRmVlZGJhY2s6IFtZb3VyIHNwZWNpZmljIGZlZWRiYWNrIGhlcmVdXG5cbiMjIEltcGFjdCBTdGF0ZW1lbnRcblN0YXR1czogW1lFUy9OT11cbkZlZWRiYWNrOiBbWW91ciBzcGVjaWZpYyBmZWVkYmFjayBoZXJlXVxuXG4jIyBNaXNzaW9uIFN0YXRlbWVudFxuU3RhdHVzOiBbWUVTL05PXVxuRmVlZGJhY2s6IFtZb3VyIHNwZWNpZmljIGZlZWRiYWNrIGhlcmVdXG5cbiMjIEdvYWxzICYgT2JqZWN0aXZlc1xuU3RhdHVzOiBbWUVTL05PXVxuRmVlZGJhY2s6IFtZb3VyIHNwZWNpZmljIGZlZWRiYWNrIGhlcmVdXG5cbiMjIEJ1ZGdldCBKdXN0aWZpY2F0aW9uXG5TdGF0dXM6IFtZRVMvTk9dXG5GZWVkYmFjazogW1lvdXIgc3BlY2lmaWMgZmVlZGJhY2sgaGVyZV1cblxuQmUgc3BlY2lmaWMgaW4geW91ciBmZWVkYmFjaywgZXhwbGFpbmluZyBleGFjdGx5IHdoYXQgaXNuJ3Qgd29ya2luZyBhbmQgd2h5LmA7XG5cbmNvbnN0IElNUFJPVkVNRU5UX1BST01QVCA9IGBCYXNlZCBvbiB0aGUgY3JpdGlxdWUgcHJvdmlkZWQsIGdlbmVyYXRlIHR3byBkaXN0aW5jdGx5IGRpZmZlcmVudCBhcHByb2FjaGVzIGZvciBpbXByb3ZpbmcgdGhpcyBzZWN0aW9uOiB7c2VjdGlvbn0uIFxuXG5Gb3IgY29udGV4dCwgaGVyZSBpcyB0aGUgZnVsbCBkcmFmdDpcbntjb250ZW50fVxuXG5Gb3JtYXQgeW91ciByZXNwb25zZSBleGFjdGx5IGxpa2UgdGhpczpcblxuT3B0aW9uIDE6XG5bQ29tcGxldGUgcmV3cml0ZSB3aXRoIGZpcnN0IGFwcHJvYWNoIC0gZm9jdXMgb24gYmVpbmcgZGlyZWN0IGFuZCBpbXBhY3RmdWxdXG5cbk9wdGlvbiAyOlxuW0NvbXBsZXRlIHJld3JpdGUgd2l0aCBzZWNvbmQgYXBwcm9hY2ggLSBmb2N1cyBvbiBiZWluZyBkZXNjcmlwdGl2ZSBhbmQgZGV0YWlsZWRdXG5cbk1ha2UgZWFjaCBvcHRpb24gZGlzdGluY3RseSBkaWZmZXJlbnQgaW4gdG9uZSBhbmQgZW1waGFzaXMuIEVhY2ggb3B0aW9uIHNob3VsZCBiZSBjb21wbGV0ZSBhbmQgcmVhZHkgdG8gdXNlLlxuRWFjaCBvcHRpb24gc2hvdWxkIG1haW50YWluIHByb3BlciBmb3JtYXR0aW5nIGFuZCBzdHJ1Y3R1cmUuYDtcblxuY29uc3QgRklOQUxfUkVWSUVXX1BST01QVCA9IGBSZXZpZXcgdGhpcyBkcmFmdCBob2xpc3RpY2FsbHkgYW5kIHByb3ZpZGUgYWN0aW9uYWJsZSBmZWVkYmFjay4gQ29uc2lkZXIgaG93IHdlbGwgaXQgZmxvd3MgYW5kIGlmIGl0IHByZXNlbnRzIGEgY29tcGVsbGluZyBuYXJyYXRpdmUuXG5cbkZvcm1hdCB5b3VyIHJlc3BvbnNlIGxpa2UgdGhpczpcblxuIyMgT3ZlcmFsbCBBc3Nlc3NtZW50XG5bUHJvdmlkZSBhIGJyaWVmIGV2YWx1YXRpb24gb2YgdGhlIGRyYWZ0J3MgZWZmZWN0aXZlbmVzcyBhbmQgcG90ZW50aWFsIGltcGFjdF1cblxuIyMgS2V5IFN0cmVuZ3Roc1xuLSBbU3BlY2lmaWMgc3RyZW5ndGggd2l0aCBleHBsYW5hdGlvbl1cbi0gW1NwZWNpZmljIHN0cmVuZ3RoIHdpdGggZXhwbGFuYXRpb25dXG4tIFtTcGVjaWZpYyBzdHJlbmd0aCB3aXRoIGV4cGxhbmF0aW9uXVxuXG4jIyBSZWNvbW1lbmRlZCBJbXByb3ZlbWVudHNcbi0gW1NwZWNpZmljLCBhY3Rpb25hYmxlIGltcHJvdmVtZW50IHN1Z2dlc3Rpb25dXG4tIFtTcGVjaWZpYywgYWN0aW9uYWJsZSBpbXByb3ZlbWVudCBzdWdnZXN0aW9uXVxuLSBbU3BlY2lmaWMsIGFjdGlvbmFibGUgaW1wcm92ZW1lbnQgc3VnZ2VzdGlvbl1cblxuIyMgRmluYWwgUmVjb21tZW5kYXRpb25zXG5bQ29uY3JldGUgbmV4dCBzdGVwcyBhbmQgc3VnZ2VzdGlvbnMgZm9yIHN0cmVuZ3RoZW5pbmcgdGhlIHByb3Bvc2FsIGZ1cnRoZXJdYDtcblxuY29uc3QgZ2VuZXJhdGlvbkNvbmZpZyA9IHtcbiAgdGVtcGVyYXR1cmU6IDEsXG4gIHRvcFA6IDAuOTUsXG4gIHRvcEs6IDY0LFxuICBtYXhPdXRwdXRUb2tlbnM6IDgxOTIsXG59O1xuXG5leHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiBoYW5kbGVyKHJlcSwgcmVzKSB7XG4gIGlmIChyZXEubWV0aG9kICE9PSAnUE9TVCcpIHtcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDUpLmpzb24oeyBlcnJvcjogJ01ldGhvZCBub3QgYWxsb3dlZCcgfSk7XG4gIH1cblxuICB0cnkge1xuICAgIGlmICghcHJvY2Vzcy5lbnYuR09PR0xFX0FJX0FQSV9LRVkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignR09PR0xFX0FJX0FQSV9LRVkgaXMgbm90IGNvbmZpZ3VyZWQnKTtcbiAgICB9XG5cbiAgICBjb25zdCB7IGFjdGlvbiwgdGV4dCwgc2VjdGlvbnMgfSA9IHJlcS5ib2R5O1xuXG4gICAgaWYgKCF0ZXh0KSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBlcnJvcjogJ1RleHQgY29udGVudCBpcyByZXF1aXJlZCcgfSk7XG4gICAgfVxuXG4gICAgLy8gQ2xlYW4gdGhlIHRleHQgY29udGVudFxuICAgIGNvbnN0IGNsZWFuVGV4dCA9IHRleHQucmVwbGFjZSgvYC9nLCAnJykudHJpbSgpO1xuICAgIGlmICghY2xlYW5UZXh0KSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBlcnJvcjogJ1RleHQgY29udGVudCBpcyBlbXB0eSBhZnRlciBjbGVhbmluZycgfSk7XG4gICAgfVxuXG4gICAgY29uc3QgbW9kZWwgPSBnZW5BSS5nZXRHZW5lcmF0aXZlTW9kZWwoeyBcbiAgICAgIG1vZGVsOiBcImdlbWluaS1wcm9cIixcbiAgICAgIGdlbmVyYXRpb25Db25maWcsXG4gICAgfSk7XG5cbiAgICBsZXQgcHJvbXB0O1xuICAgIHN3aXRjaCAoYWN0aW9uKSB7XG4gICAgICBjYXNlICdjcml0aXF1ZSc6XG4gICAgICAgIHByb21wdCA9IENSSVRJUVVFX1BST01QVDtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdpbXByb3ZlJzpcbiAgICAgICAgaWYgKCFzZWN0aW9ucyB8fCBzZWN0aW9ucy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBlcnJvcjogJ1NlY3Rpb25zIGFyZSByZXF1aXJlZCBmb3IgaW1wcm92ZW1lbnRzJyB9KTtcbiAgICAgICAgfVxuICAgICAgICAvLyBIYW5kbGUgbXVsdGlwbGUgc2VjdGlvbnMgYXQgb25jZVxuICAgICAgICBjb25zdCBpbXByb3ZlbWVudHMgPSB7fTtcbiAgICAgICAgZm9yIChjb25zdCBzZWN0aW9uIG9mIHNlY3Rpb25zKSB7XG4gICAgICAgICAgY29uc3Qgc2VjdGlvblByb21wdCA9IElNUFJPVkVNRU5UX1BST01QVFxuICAgICAgICAgICAgLnJlcGxhY2UoJ3tzZWN0aW9ufScsIHNlY3Rpb24pXG4gICAgICAgICAgICAucmVwbGFjZSgne2NvbnRlbnR9JywgY2xlYW5UZXh0KTtcbiAgICAgICAgICBcbiAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBtb2RlbC5nZW5lcmF0ZUNvbnRlbnQoc2VjdGlvblByb21wdCk7XG4gICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXN1bHQucmVzcG9uc2U7XG4gICAgICAgICAgY29uc3QgdGV4dCA9IHJlc3BvbnNlLnRleHQoKTtcbiAgICAgICAgICBcbiAgICAgICAgICAvLyBQYXJzZSB0aGUgdHdvIG9wdGlvbnNcbiAgICAgICAgICBjb25zdCBwYXJ0cyA9IHRleHQuc3BsaXQoL09wdGlvbiBbMTJdOi8pO1xuICAgICAgICAgIGlmIChwYXJ0cy5sZW5ndGggPCAzKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdJbnZhbGlkIGltcHJvdmVtZW50IGZvcm1hdCBmb3Igc2VjdGlvbjonLCBzZWN0aW9uKTtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpbXByb3ZlbWVudHNbc2VjdGlvbl0gPSBbcGFydHNbMV0udHJpbSgpLCBwYXJ0c1syXS50cmltKCldO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbih7IGltcHJvdmVtZW50cyB9KTtcblxuICAgICAgY2FzZSAnZmluYWwnOlxuICAgICAgICBwcm9tcHQgPSBGSU5BTF9SRVZJRVdfUFJPTVBUO1xuICAgICAgICBicmVhaztcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IGVycm9yOiAnSW52YWxpZCBhY3Rpb24nIH0pO1xuICAgIH1cblxuICAgIGNvbnNvbGUubG9nKGBQcm9jZXNzaW5nICR7YWN0aW9ufSByZXF1ZXN0Li4uYCk7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgbW9kZWwuZ2VuZXJhdGVDb250ZW50KHByb21wdCArIFwiXFxuXFxuXCIgKyBjbGVhblRleHQpO1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVzdWx0LnJlc3BvbnNlO1xuICAgIGNvbnN0IHJlc3BvbnNlVGV4dCA9IHJlc3BvbnNlLnRleHQoKTtcblxuICAgIGlmICghcmVzcG9uc2VUZXh0IHx8IHJlc3BvbnNlVGV4dC50cmltKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0VtcHR5IHJlc3BvbnNlIGZyb20gQUknKTtcbiAgICB9XG5cbiAgICBpZiAoYWN0aW9uID09PSAnY3JpdGlxdWUnKSB7XG4gICAgICBjb25zdCBzZWN0aW9ucyA9IHt9O1xuICAgICAgbGV0IGN1cnJlbnRTZWN0aW9uID0gbnVsbDtcbiAgICAgIGxldCBjdXJyZW50U3RhdHVzID0gbnVsbDtcbiAgICAgIGxldCBjdXJyZW50RmVlZGJhY2sgPSBbXTtcblxuICAgICAgY29uc3QgbGluZXMgPSByZXNwb25zZVRleHQuc3BsaXQoJ1xcbicpO1xuICAgICAgZm9yIChsZXQgbGluZSBvZiBsaW5lcykge1xuICAgICAgICBsaW5lID0gbGluZS50cmltKCk7XG4gICAgICAgIGlmICghbGluZSkgY29udGludWU7XG5cbiAgICAgICAgaWYgKGxpbmUuc3RhcnRzV2l0aCgnIyMgJykpIHtcbiAgICAgICAgICBpZiAoY3VycmVudFNlY3Rpb24pIHtcbiAgICAgICAgICAgIGNvbnN0IGtleSA9IGN1cnJlbnRTZWN0aW9uLnRvTG93ZXJDYXNlKCkucmVwbGFjZSgvW15hLXowLTldKy9nLCAnXycpO1xuICAgICAgICAgICAgc2VjdGlvbnNba2V5XSA9IHtcbiAgICAgICAgICAgICAgaWQ6IGtleSxcbiAgICAgICAgICAgICAgbmFtZTogY3VycmVudFNlY3Rpb24sXG4gICAgICAgICAgICAgIG5lZWRzV29yazogY3VycmVudFN0YXR1cyA9PT0gJ1lFUycsXG4gICAgICAgICAgICAgIGZlZWRiYWNrOiBjdXJyZW50RmVlZGJhY2suam9pbignXFxuJykudHJpbSgpLFxuICAgICAgICAgICAgICB0ZXh0OiAnJyAvLyBXaWxsIGJlIHBvcHVsYXRlZCBmcm9tIHRoZSBkcmFmdFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY3VycmVudFNlY3Rpb24gPSBsaW5lLnJlcGxhY2UoJyMjICcsICcnKS50cmltKCk7XG4gICAgICAgICAgY3VycmVudFN0YXR1cyA9IG51bGw7XG4gICAgICAgICAgY3VycmVudEZlZWRiYWNrID0gW107XG4gICAgICAgIH0gZWxzZSBpZiAobGluZS5zdGFydHNXaXRoKCdTdGF0dXM6JykpIHtcbiAgICAgICAgICBjdXJyZW50U3RhdHVzID0gbGluZS5yZXBsYWNlKCdTdGF0dXM6JywgJycpLnRyaW0oKTtcbiAgICAgICAgfSBlbHNlIGlmIChsaW5lLnN0YXJ0c1dpdGgoJ0ZlZWRiYWNrOicpKSB7XG4gICAgICAgICAgY3VycmVudEZlZWRiYWNrID0gW2xpbmUucmVwbGFjZSgnRmVlZGJhY2s6JywgJycpLnRyaW0oKV07XG4gICAgICAgIH0gZWxzZSBpZiAoY3VycmVudEZlZWRiYWNrKSB7XG4gICAgICAgICAgY3VycmVudEZlZWRiYWNrLnB1c2gobGluZSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gU2F2ZSB0aGUgbGFzdCBzZWN0aW9uXG4gICAgICBpZiAoY3VycmVudFNlY3Rpb24pIHtcbiAgICAgICAgY29uc3Qga2V5ID0gY3VycmVudFNlY3Rpb24udG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9bXmEtejAtOV0rL2csICdfJyk7XG4gICAgICAgIHNlY3Rpb25zW2tleV0gPSB7XG4gICAgICAgICAgaWQ6IGtleSxcbiAgICAgICAgICBuYW1lOiBjdXJyZW50U2VjdGlvbixcbiAgICAgICAgICBuZWVkc1dvcms6IGN1cnJlbnRTdGF0dXMgPT09ICdZRVMnLFxuICAgICAgICAgIGZlZWRiYWNrOiBjdXJyZW50RmVlZGJhY2suam9pbignXFxuJykudHJpbSgpLFxuICAgICAgICAgIHRleHQ6ICcnIC8vIFdpbGwgYmUgcG9wdWxhdGVkIGZyb20gdGhlIGRyYWZ0XG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIC8vIEV4dHJhY3Qgc2VjdGlvbiBjb250ZW50IGZyb20gdGhlIGRyYWZ0XG4gICAgICBsZXQgY3VycmVudERyYWZ0U2VjdGlvbiA9IG51bGw7XG4gICAgICBsZXQgY3VycmVudENvbnRlbnQgPSBbXTtcbiAgICAgIGNvbnN0IGRyYWZ0TGluZXMgPSBjbGVhblRleHQuc3BsaXQoJ1xcbicpO1xuICAgICAgXG4gICAgICBmb3IgKGNvbnN0IGxpbmUgb2YgZHJhZnRMaW5lcykge1xuICAgICAgICBpZiAobGluZS50cmltKCkuc3RhcnRzV2l0aCgnIyMgJykpIHtcbiAgICAgICAgICBpZiAoY3VycmVudERyYWZ0U2VjdGlvbikge1xuICAgICAgICAgICAgY29uc3Qga2V5ID0gY3VycmVudERyYWZ0U2VjdGlvbi50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL1teYS16MC05XSsvZywgJ18nKTtcbiAgICAgICAgICAgIGlmIChzZWN0aW9uc1trZXldKSB7XG4gICAgICAgICAgICAgIHNlY3Rpb25zW2tleV0udGV4dCA9IGN1cnJlbnRDb250ZW50LmpvaW4oJ1xcbicpLnRyaW0oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgY3VycmVudERyYWZ0U2VjdGlvbiA9IGxpbmUucmVwbGFjZSgvXiMjIC8sICcnKS50cmltKCk7XG4gICAgICAgICAgY3VycmVudENvbnRlbnQgPSBbXTtcbiAgICAgICAgfSBlbHNlIGlmIChjdXJyZW50RHJhZnRTZWN0aW9uKSB7XG4gICAgICAgICAgY3VycmVudENvbnRlbnQucHVzaChsaW5lKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBTYXZlIHRoZSBsYXN0IHNlY3Rpb24gY29udGVudFxuICAgICAgaWYgKGN1cnJlbnREcmFmdFNlY3Rpb24pIHtcbiAgICAgICAgY29uc3Qga2V5ID0gY3VycmVudERyYWZ0U2VjdGlvbi50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL1teYS16MC05XSsvZywgJ18nKTtcbiAgICAgICAgaWYgKHNlY3Rpb25zW2tleV0pIHtcbiAgICAgICAgICBzZWN0aW9uc1trZXldLnRleHQgPSBjdXJyZW50Q29udGVudC5qb2luKCdcXG4nKS50cmltKCk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgc2VjdGlvbnM6IE9iamVjdC52YWx1ZXMoc2VjdGlvbnMpIH0pO1xuICAgIH1cblxuICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbih7IGZlZWRiYWNrOiByZXNwb25zZVRleHQgfSk7XG5cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdBSSBBUEkgRXJyb3I6JywgZXJyb3IpO1xuICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7IFxuICAgICAgZXJyb3I6ICdGYWlsZWQgdG8gcHJvY2VzcyB3aXRoIEFJJyxcbiAgICAgIGRldGFpbHM6IGVycm9yLm1lc3NhZ2UgXG4gICAgfSk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJHb29nbGVHZW5lcmF0aXZlQUkiLCJnZW5BSSIsInByb2Nlc3MiLCJlbnYiLCJHT09HTEVfQUlfQVBJX0tFWSIsIkNSSVRJUVVFX1BST01QVCIsIklNUFJPVkVNRU5UX1BST01QVCIsIkZJTkFMX1JFVklFV19QUk9NUFQiLCJnZW5lcmF0aW9uQ29uZmlnIiwidGVtcGVyYXR1cmUiLCJ0b3BQIiwidG9wSyIsIm1heE91dHB1dFRva2VucyIsImhhbmRsZXIiLCJyZXEiLCJyZXMiLCJtZXRob2QiLCJzdGF0dXMiLCJqc29uIiwiZXJyb3IiLCJFcnJvciIsImFjdGlvbiIsInRleHQiLCJzZWN0aW9ucyIsImJvZHkiLCJjbGVhblRleHQiLCJyZXBsYWNlIiwidHJpbSIsIm1vZGVsIiwiZ2V0R2VuZXJhdGl2ZU1vZGVsIiwicHJvbXB0IiwibGVuZ3RoIiwiaW1wcm92ZW1lbnRzIiwic2VjdGlvbiIsInNlY3Rpb25Qcm9tcHQiLCJyZXN1bHQiLCJnZW5lcmF0ZUNvbnRlbnQiLCJyZXNwb25zZSIsInBhcnRzIiwic3BsaXQiLCJjb25zb2xlIiwibG9nIiwicmVzcG9uc2VUZXh0IiwiY3VycmVudFNlY3Rpb24iLCJjdXJyZW50U3RhdHVzIiwiY3VycmVudEZlZWRiYWNrIiwibGluZXMiLCJsaW5lIiwic3RhcnRzV2l0aCIsImtleSIsInRvTG93ZXJDYXNlIiwiaWQiLCJuYW1lIiwibmVlZHNXb3JrIiwiZmVlZGJhY2siLCJqb2luIiwicHVzaCIsImN1cnJlbnREcmFmdFNlY3Rpb24iLCJjdXJyZW50Q29udGVudCIsImRyYWZ0TGluZXMiLCJPYmplY3QiLCJ2YWx1ZXMiLCJkZXRhaWxzIiwibWVzc2FnZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./pages/api/ai.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fai&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fai.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();