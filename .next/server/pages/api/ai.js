"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/ai";
exports.ids = ["pages/api/ai"];
exports.modules = {

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "@google/generative-ai":
/*!****************************************!*\
  !*** external "@google/generative-ai" ***!
  \****************************************/
/***/ ((module) => {

module.exports = import("@google/generative-ai");;

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fai&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fai.js&middlewareConfigBase64=e30%3D!":
/*!**********************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fai&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fai.js&middlewareConfigBase64=e30%3D! ***!
  \**********************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_ai_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages/api/ai.js */ \"(api)/./pages/api/ai.js\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_pages_api_ai_js__WEBPACK_IMPORTED_MODULE_3__]);\n_pages_api_ai_js__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_ai_js__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_ai_js__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/ai\",\n        pathname: \"/api/ai\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_ai_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRmFpJnByZWZlcnJlZFJlZ2lvbj0mYWJzb2x1dGVQYWdlUGF0aD0uJTJGcGFnZXMlMkZhcGklMkZhaS5qcyZtaWRkbGV3YXJlQ29uZmlnQmFzZTY0PWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDTDtBQUMxRDtBQUM4QztBQUM5QztBQUNBLGlFQUFlLHdFQUFLLENBQUMsNkNBQVEsWUFBWSxFQUFDO0FBQzFDO0FBQ08sZUFBZSx3RUFBSyxDQUFDLDZDQUFRO0FBQ3BDO0FBQ08sd0JBQXdCLGdIQUFtQjtBQUNsRDtBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxZQUFZO0FBQ1osQ0FBQzs7QUFFRCxxQyIsInNvdXJjZXMiOlsid2VicGFjazovL2dyYW50LXdyaXRlci8/ZGJiZSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQYWdlc0FQSVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvcGFnZXMtYXBpL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IGhvaXN0IH0gZnJvbSBcIm5leHQvZGlzdC9idWlsZC90ZW1wbGF0ZXMvaGVscGVyc1wiO1xuLy8gSW1wb3J0IHRoZSB1c2VybGFuZCBjb2RlLlxuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi4vcGFnZXMvYXBpL2FpLmpzXCI7XG4vLyBSZS1leHBvcnQgdGhlIGhhbmRsZXIgKHNob3VsZCBiZSB0aGUgZGVmYXVsdCBleHBvcnQpLlxuZXhwb3J0IGRlZmF1bHQgaG9pc3QodXNlcmxhbmQsIFwiZGVmYXVsdFwiKTtcbi8vIFJlLWV4cG9ydCBjb25maWcuXG5leHBvcnQgY29uc3QgY29uZmlnID0gaG9pc3QodXNlcmxhbmQsIFwiY29uZmlnXCIpO1xuLy8gQ3JlYXRlIGFuZCBleHBvcnQgdGhlIHJvdXRlIG1vZHVsZSB0aGF0IHdpbGwgYmUgY29uc3VtZWQuXG5leHBvcnQgY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgUGFnZXNBUElSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuUEFHRVNfQVBJLFxuICAgICAgICBwYWdlOiBcIi9hcGkvYWlcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9haVwiLFxuICAgICAgICAvLyBUaGUgZm9sbG93aW5nIGFyZW4ndCB1c2VkIGluIHByb2R1Y3Rpb24uXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcIlwiXG4gICAgfSxcbiAgICB1c2VybGFuZFxufSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhZ2VzLWFwaS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fai&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fai.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./pages/api/ai.js":
/*!*************************!*\
  !*** ./pages/api/ai.js ***!
  \*************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _google_generative_ai__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @google/generative-ai */ \"@google/generative-ai\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_google_generative_ai__WEBPACK_IMPORTED_MODULE_0__]);\n_google_generative_ai__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\nconst genAI = new _google_generative_ai__WEBPACK_IMPORTED_MODULE_0__.GoogleGenerativeAI(\"AIzaSyBHu8vw1XvJKGufalwm3iLIuDc2gvh6Tgk\");\nconst CRITIQUE_PROMPT = `You are an expert grant writer who helps to connect small non-profits and startups led by powerful, strong, BIPOC women with financial abundance that allows the grant recipients to do tremendous good in the world.\n\nAnalyze the grant proposal and provide feedback in the following format:\n\n# Section Analysis\nFor each section below, indicate if it needs improvement (YES/NO) and provide specific feedback:\n\n## Opening Hook\nStatus: [YES/NO]\nFeedback: [Your specific feedback here]\n\n## Impact Statement\nStatus: [YES/NO]\nFeedback: [Your specific feedback here]\n\n## Mission Statement\nStatus: [YES/NO]\nFeedback: [Your specific feedback here]\n\n## Goals & Objectives\nStatus: [YES/NO]\nFeedback: [Your specific feedback here]\n\n## Budget Justification\nStatus: [YES/NO]\nFeedback: [Your specific feedback here]\n\nBe specific in your feedback, explaining exactly what isn't working and why.`;\nconst IMPROVEMENT_PROMPT = `Based on the critique provided, generate two distinctly different approaches for improving this section: {section}. \n\nFor context, here is the full draft:\n{content}\n\nFormat your response exactly like this:\n\nOption 1:\n[Complete rewrite with first approach - focus on being direct and impactful]\n\nOption 2:\n[Complete rewrite with second approach - focus on being descriptive and detailed]\n\nMake each option distinctly different in tone and emphasis. Each option should be complete and ready to use.\nEach option should maintain proper formatting and structure.`;\nconst FINAL_REVIEW_PROMPT = `Review this draft holistically and provide actionable feedback. Consider how well it flows and if it presents a compelling narrative.\n\nFormat your response like this:\n\n## Overall Assessment\n[Provide a brief evaluation of the draft's effectiveness and potential impact]\n\n## Key Strengths\n- [Specific strength with explanation]\n- [Specific strength with explanation]\n- [Specific strength with explanation]\n\n## Recommended Improvements\n- [Specific, actionable improvement suggestion]\n- [Specific, actionable improvement suggestion]\n- [Specific, actionable improvement suggestion]\n\n## Final Recommendations\n[Concrete next steps and suggestions for strengthening the proposal further]`;\nconst generationConfig = {\n    temperature: 1,\n    topP: 0.95,\n    topK: 64,\n    maxOutputTokens: 8192\n};\nasync function handler(req, res) {\n    if (req.method !== \"POST\") {\n        return res.status(405).json({\n            error: \"Method not allowed\"\n        });\n    }\n    try {\n        if (false) {}\n        const { draft, stage, section } = req.body;\n        if (!draft) {\n            return res.status(400).json({\n                error: \"Draft content is required\"\n            });\n        }\n        // Clean the draft content\n        const cleanDraft = draft.replace(/`/g, \"\").trim();\n        if (!cleanDraft) {\n            return res.status(400).json({\n                error: \"Draft content is empty after cleaning\"\n            });\n        }\n        console.log(`Processing ${stage} request for draft length: ${cleanDraft.length}`);\n        const model = genAI.getGenerativeModel({\n            model: \"gemini-pro\",\n            generationConfig\n        });\n        let prompt;\n        switch(stage){\n            case \"critique\":\n                prompt = CRITIQUE_PROMPT;\n                break;\n            case \"improve\":\n                if (!section) {\n                    return res.status(400).json({\n                        error: \"Section name is required for improvements\"\n                    });\n                }\n                prompt = IMPROVEMENT_PROMPT.replace(\"{section}\", section).replace(\"{content}\", cleanDraft);\n                break;\n            case \"final\":\n                prompt = FINAL_REVIEW_PROMPT;\n                break;\n            default:\n                return res.status(400).json({\n                    error: \"Invalid stage\"\n                });\n        }\n        console.log(`Sending prompt to AI for ${stage}...`);\n        const result = await model.generateContent(prompt + \"\\n\\n\" + cleanDraft);\n        const response = await result.response;\n        const text = response.text();\n        console.log(`AI Response for ${stage}:`, text.substring(0, 100) + \"...\");\n        if (!text || text.trim().length === 0) {\n            console.error(\"Empty response from AI\");\n            return res.status(500).json({\n                error: \"Empty response from AI\",\n                details: \"The AI model returned an empty response\"\n            });\n        }\n        if (stage === \"improve\") {\n            // Split on Option 1: and Option 2: specifically\n            const parts = text.split(/Option [12]:/);\n            if (parts.length < 3) {\n                console.error(\"Invalid improvement format received:\", text);\n                return res.status(400).json({\n                    error: \"Invalid improvement format\",\n                    details: \"The AI response did not contain properly formatted options\"\n                });\n            }\n            const options = [\n                parts[1].trim(),\n                parts[2].trim()\n            ];\n            return res.status(200).json({\n                options\n            });\n        } else if (stage === \"critique\") {\n            const sections = {};\n            let currentSection = null;\n            let currentStatus = null;\n            let currentFeedback = [];\n            // Process AI response first to get feedback\n            const lines = text.split(\"\\n\");\n            for (let line of lines){\n                line = line.trim();\n                if (!line) continue;\n                if (line.startsWith(\"## \")) {\n                    // Save previous section if exists\n                    if (currentSection) {\n                        const key = currentSection.toLowerCase().replace(/[^a-z0-9]+/g, \"_\");\n                        sections[key] = {\n                            name: currentSection,\n                            needsWork: currentStatus === \"YES\",\n                            feedback: currentFeedback.join(\"\\n\").trim(),\n                            content: \"\" // Will be populated later\n                        };\n                    }\n                    // Start new section\n                    currentSection = line.replace(\"## \", \"\").trim();\n                    currentStatus = null;\n                    currentFeedback = [];\n                } else if (line.startsWith(\"Status:\")) {\n                    currentStatus = line.replace(\"Status:\", \"\").trim();\n                } else if (line.startsWith(\"Feedback:\")) {\n                    currentFeedback = [\n                        line.replace(\"Feedback:\", \"\").trim()\n                    ];\n                } else if (currentFeedback) {\n                    currentFeedback.push(line);\n                }\n            }\n            // Save the last section\n            if (currentSection) {\n                const key = currentSection.toLowerCase().replace(/[^a-z0-9]+/g, \"_\");\n                sections[key] = {\n                    name: currentSection,\n                    needsWork: currentStatus === \"YES\",\n                    feedback: currentFeedback.join(\"\\n\").trim(),\n                    content: \"\" // Will be populated later\n                };\n            }\n            // Now extract content from the draft\n            let currentDraftSection = null;\n            let currentContent = [];\n            const draftLines = cleanDraft.split(\"\\n\");\n            for (const line of draftLines){\n                if (line.trim().startsWith(\"## \")) {\n                    // Save previous section content\n                    if (currentDraftSection) {\n                        const key = currentDraftSection.toLowerCase().replace(/[^a-z0-9]+/g, \"_\");\n                        if (sections[key]) {\n                            sections[key].content = currentContent.join(\"\\n\").trim();\n                        }\n                    }\n                    currentDraftSection = line.replace(/^## /, \"\").trim();\n                    currentContent = [];\n                } else if (currentDraftSection) {\n                    currentContent.push(line);\n                }\n            }\n            // Save the last section content\n            if (currentDraftSection) {\n                const key = currentDraftSection.toLowerCase().replace(/[^a-z0-9]+/g, \"_\");\n                if (sections[key]) {\n                    sections[key].content = currentContent.join(\"\\n\").trim();\n                }\n            }\n            if (Object.keys(sections).length === 0) {\n                console.error(\"Failed to parse sections from text:\", text);\n                return res.status(400).json({\n                    error: \"Invalid critique format\",\n                    details: \"The AI response did not contain properly formatted sections\"\n                });\n            }\n            return res.status(200).json({\n                sections\n            });\n        } else {\n            return res.status(200).json({\n                feedback: text\n            });\n        }\n    } catch (error) {\n        console.error(\"AI API Error:\", error);\n        return res.status(500).json({\n            error: \"Failed to process with AI\",\n            details: error.message\n        });\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q3JCLE9BQU8sSUFBSUQscUJBQXFCO29CQUM5QkMsZUFBZUYsSUFBSSxDQUFDVDtnQkFDdEI7WUFDRjtZQUVBLGdDQUFnQztZQUNoQyxJQUFJVSxxQkFBcUI7Z0JBQ3ZCLE1BQU1SLE1BQU1RLG9CQUFvQlAsV0FBVyxHQUFHekIsT0FBTyxDQUFDLGVBQWU7Z0JBQ3JFLElBQUlpQixRQUFRLENBQUNPLElBQUksRUFBRTtvQkFDakJQLFFBQVEsQ0FBQ08sSUFBSSxDQUFDTSxPQUFPLEdBQUdHLGVBQWVKLElBQUksQ0FBQyxNQUFNNUIsSUFBSTtnQkFDeEQ7WUFDRjtZQUVBLElBQUlrQyxPQUFPQyxJQUFJLENBQUNuQixVQUFVYixNQUFNLEtBQUssR0FBRztnQkFDdENGLFFBQVFULEtBQUssQ0FBQyx1Q0FBdUNrQjtnQkFDckQsT0FBT3RCLElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7b0JBQzFCQyxPQUFPO29CQUNQb0IsU0FBUztnQkFDWDtZQUNGO1lBRUEsT0FBT3hCLElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7Z0JBQUV5QjtZQUFTO1FBQ3pDLE9BQU87WUFDTCxPQUFPNUIsSUFBSUUsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztnQkFBRW9DLFVBQVVqQjtZQUFLO1FBQy9DO0lBRUYsRUFBRSxPQUFPbEIsT0FBTztRQUNkUyxRQUFRVCxLQUFLLENBQUMsaUJBQWlCQTtRQUMvQixPQUFPSixJQUFJRSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO1lBQzFCQyxPQUFPO1lBQ1BvQixTQUFTcEIsTUFBTTRDLE9BQU87UUFDeEI7SUFDRjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZ3JhbnQtd3JpdGVyLy4vcGFnZXMvYXBpL2FpLmpzPzlkNDgiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgR29vZ2xlR2VuZXJhdGl2ZUFJIH0gZnJvbSAnQGdvb2dsZS9nZW5lcmF0aXZlLWFpJztcblxuY29uc3QgZ2VuQUkgPSBuZXcgR29vZ2xlR2VuZXJhdGl2ZUFJKHByb2Nlc3MuZW52LkdPT0dMRV9BSV9BUElfS0VZKTtcblxuY29uc3QgQ1JJVElRVUVfUFJPTVBUID0gYFlvdSBhcmUgYW4gZXhwZXJ0IGdyYW50IHdyaXRlciB3aG8gaGVscHMgdG8gY29ubmVjdCBzbWFsbCBub24tcHJvZml0cyBhbmQgc3RhcnR1cHMgbGVkIGJ5IHBvd2VyZnVsLCBzdHJvbmcsIEJJUE9DIHdvbWVuIHdpdGggZmluYW5jaWFsIGFidW5kYW5jZSB0aGF0IGFsbG93cyB0aGUgZ3JhbnQgcmVjaXBpZW50cyB0byBkbyB0cmVtZW5kb3VzIGdvb2QgaW4gdGhlIHdvcmxkLlxuXG5BbmFseXplIHRoZSBncmFudCBwcm9wb3NhbCBhbmQgcHJvdmlkZSBmZWVkYmFjayBpbiB0aGUgZm9sbG93aW5nIGZvcm1hdDpcblxuIyBTZWN0aW9uIEFuYWx5c2lzXG5Gb3IgZWFjaCBzZWN0aW9uIGJlbG93LCBpbmRpY2F0ZSBpZiBpdCBuZWVkcyBpbXByb3ZlbWVudCAoWUVTL05PKSBhbmQgcHJvdmlkZSBzcGVjaWZpYyBmZWVkYmFjazpcblxuIyMgT3BlbmluZyBIb29rXG5TdGF0dXM6IFtZRVMvTk9dXG5GZWVkYmFjazogW1lvdXIgc3BlY2lmaWMgZmVlZGJhY2sgaGVyZV1cblxuIyMgSW1wYWN0IFN0YXRlbWVudFxuU3RhdHVzOiBbWUVTL05PXVxuRmVlZGJhY2s6IFtZb3VyIHNwZWNpZmljIGZlZWRiYWNrIGhlcmVdXG5cbiMjIE1pc3Npb24gU3RhdGVtZW50XG5TdGF0dXM6IFtZRVMvTk9dXG5GZWVkYmFjazogW1lvdXIgc3BlY2lmaWMgZmVlZGJhY2sgaGVyZV1cblxuIyMgR29hbHMgJiBPYmplY3RpdmVzXG5TdGF0dXM6IFtZRVMvTk9dXG5GZWVkYmFjazogW1lvdXIgc3BlY2lmaWMgZmVlZGJhY2sgaGVyZV1cblxuIyMgQnVkZ2V0IEp1c3RpZmljYXRpb25cblN0YXR1czogW1lFUy9OT11cbkZlZWRiYWNrOiBbWW91ciBzcGVjaWZpYyBmZWVkYmFjayBoZXJlXVxuXG5CZSBzcGVjaWZpYyBpbiB5b3VyIGZlZWRiYWNrLCBleHBsYWluaW5nIGV4YWN0bHkgd2hhdCBpc24ndCB3b3JraW5nIGFuZCB3aHkuYDtcblxuY29uc3QgSU1QUk9WRU1FTlRfUFJPTVBUID0gYEJhc2VkIG9uIHRoZSBjcml0aXF1ZSBwcm92aWRlZCwgZ2VuZXJhdGUgdHdvIGRpc3RpbmN0bHkgZGlmZmVyZW50IGFwcHJvYWNoZXMgZm9yIGltcHJvdmluZyB0aGlzIHNlY3Rpb246IHtzZWN0aW9ufS4gXG5cbkZvciBjb250ZXh0LCBoZXJlIGlzIHRoZSBmdWxsIGRyYWZ0Olxue2NvbnRlbnR9XG5cbkZvcm1hdCB5b3VyIHJlc3BvbnNlIGV4YWN0bHkgbGlrZSB0aGlzOlxuXG5PcHRpb24gMTpcbltDb21wbGV0ZSByZXdyaXRlIHdpdGggZmlyc3QgYXBwcm9hY2ggLSBmb2N1cyBvbiBiZWluZyBkaXJlY3QgYW5kIGltcGFjdGZ1bF1cblxuT3B0aW9uIDI6XG5bQ29tcGxldGUgcmV3cml0ZSB3aXRoIHNlY29uZCBhcHByb2FjaCAtIGZvY3VzIG9uIGJlaW5nIGRlc2NyaXB0aXZlIGFuZCBkZXRhaWxlZF1cblxuTWFrZSBlYWNoIG9wdGlvbiBkaXN0aW5jdGx5IGRpZmZlcmVudCBpbiB0b25lIGFuZCBlbXBoYXNpcy4gRWFjaCBvcHRpb24gc2hvdWxkIGJlIGNvbXBsZXRlIGFuZCByZWFkeSB0byB1c2UuXG5FYWNoIG9wdGlvbiBzaG91bGQgbWFpbnRhaW4gcHJvcGVyIGZvcm1hdHRpbmcgYW5kIHN0cnVjdHVyZS5gO1xuXG5jb25zdCBGSU5BTF9SRVZJRVdfUFJPTVBUID0gYFJldmlldyB0aGlzIGRyYWZ0IGhvbGlzdGljYWxseSBhbmQgcHJvdmlkZSBhY3Rpb25hYmxlIGZlZWRiYWNrLiBDb25zaWRlciBob3cgd2VsbCBpdCBmbG93cyBhbmQgaWYgaXQgcHJlc2VudHMgYSBjb21wZWxsaW5nIG5hcnJhdGl2ZS5cblxuRm9ybWF0IHlvdXIgcmVzcG9uc2UgbGlrZSB0aGlzOlxuXG4jIyBPdmVyYWxsIEFzc2Vzc21lbnRcbltQcm92aWRlIGEgYnJpZWYgZXZhbHVhdGlvbiBvZiB0aGUgZHJhZnQncyBlZmZlY3RpdmVuZXNzIGFuZCBwb3RlbnRpYWwgaW1wYWN0XVxuXG4jIyBLZXkgU3RyZW5ndGhzXG4tIFtTcGVjaWZpYyBzdHJlbmd0aCB3aXRoIGV4cGxhbmF0aW9uXVxuLSBbU3BlY2lmaWMgc3RyZW5ndGggd2l0aCBleHBsYW5hdGlvbl1cbi0gW1NwZWNpZmljIHN0cmVuZ3RoIHdpdGggZXhwbGFuYXRpb25dXG5cbiMjIFJlY29tbWVuZGVkIEltcHJvdmVtZW50c1xuLSBbU3BlY2lmaWMsIGFjdGlvbmFibGUgaW1wcm92ZW1lbnQgc3VnZ2VzdGlvbl1cbi0gW1NwZWNpZmljLCBhY3Rpb25hYmxlIGltcHJvdmVtZW50IHN1Z2dlc3Rpb25dXG4tIFtTcGVjaWZpYywgYWN0aW9uYWJsZSBpbXByb3ZlbWVudCBzdWdnZXN0aW9uXVxuXG4jIyBGaW5hbCBSZWNvbW1lbmRhdGlvbnNcbltDb25jcmV0ZSBuZXh0IHN0ZXBzIGFuZCBzdWdnZXN0aW9ucyBmb3Igc3RyZW5ndGhlbmluZyB0aGUgcHJvcG9zYWwgZnVydGhlcl1gO1xuXG5jb25zdCBnZW5lcmF0aW9uQ29uZmlnID0ge1xuICB0ZW1wZXJhdHVyZTogMSxcbiAgdG9wUDogMC45NSxcbiAgdG9wSzogNjQsXG4gIG1heE91dHB1dFRva2VuczogODE5Mixcbn07XG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIocmVxLCByZXMpIHtcbiAgaWYgKHJlcS5tZXRob2QgIT09ICdQT1NUJykge1xuICAgIHJldHVybiByZXMuc3RhdHVzKDQwNSkuanNvbih7IGVycm9yOiAnTWV0aG9kIG5vdCBhbGxvd2VkJyB9KTtcbiAgfVxuXG4gIHRyeSB7XG4gICAgaWYgKCFwcm9jZXNzLmVudi5HT09HTEVfQUlfQVBJX0tFWSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdHT09HTEVfQUlfQVBJX0tFWSBpcyBub3QgY29uZmlndXJlZCcpO1xuICAgIH1cblxuICAgIGNvbnN0IHsgZHJhZnQsIHN0YWdlLCBzZWN0aW9uIH0gPSByZXEuYm9keTtcblxuICAgIGlmICghZHJhZnQpIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IGVycm9yOiAnRHJhZnQgY29udGVudCBpcyByZXF1aXJlZCcgfSk7XG4gICAgfVxuXG4gICAgLy8gQ2xlYW4gdGhlIGRyYWZ0IGNvbnRlbnRcbiAgICBjb25zdCBjbGVhbkRyYWZ0ID0gZHJhZnQucmVwbGFjZSgvYC9nLCAnJykudHJpbSgpO1xuICAgIGlmICghY2xlYW5EcmFmdCkge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgZXJyb3I6ICdEcmFmdCBjb250ZW50IGlzIGVtcHR5IGFmdGVyIGNsZWFuaW5nJyB9KTtcbiAgICB9XG5cbiAgICBjb25zb2xlLmxvZyhgUHJvY2Vzc2luZyAke3N0YWdlfSByZXF1ZXN0IGZvciBkcmFmdCBsZW5ndGg6ICR7Y2xlYW5EcmFmdC5sZW5ndGh9YCk7XG5cbiAgICBjb25zdCBtb2RlbCA9IGdlbkFJLmdldEdlbmVyYXRpdmVNb2RlbCh7IFxuICAgICAgbW9kZWw6IFwiZ2VtaW5pLXByb1wiLFxuICAgICAgZ2VuZXJhdGlvbkNvbmZpZyxcbiAgICB9KTtcblxuICAgIGxldCBwcm9tcHQ7XG4gICAgc3dpdGNoIChzdGFnZSkge1xuICAgICAgY2FzZSAnY3JpdGlxdWUnOlxuICAgICAgICBwcm9tcHQgPSBDUklUSVFVRV9QUk9NUFQ7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnaW1wcm92ZSc6XG4gICAgICAgIGlmICghc2VjdGlvbikge1xuICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IGVycm9yOiAnU2VjdGlvbiBuYW1lIGlzIHJlcXVpcmVkIGZvciBpbXByb3ZlbWVudHMnIH0pO1xuICAgICAgICB9XG4gICAgICAgIHByb21wdCA9IElNUFJPVkVNRU5UX1BST01QVFxuICAgICAgICAgIC5yZXBsYWNlKCd7c2VjdGlvbn0nLCBzZWN0aW9uKVxuICAgICAgICAgIC5yZXBsYWNlKCd7Y29udGVudH0nLCBjbGVhbkRyYWZ0KTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdmaW5hbCc6XG4gICAgICAgIHByb21wdCA9IEZJTkFMX1JFVklFV19QUk9NUFQ7XG4gICAgICAgIGJyZWFrO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgZXJyb3I6ICdJbnZhbGlkIHN0YWdlJyB9KTtcbiAgICB9XG5cbiAgICBjb25zb2xlLmxvZyhgU2VuZGluZyBwcm9tcHQgdG8gQUkgZm9yICR7c3RhZ2V9Li4uYCk7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgbW9kZWwuZ2VuZXJhdGVDb250ZW50KHByb21wdCArIFwiXFxuXFxuXCIgKyBjbGVhbkRyYWZ0KTtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlc3VsdC5yZXNwb25zZTtcbiAgICBjb25zdCB0ZXh0ID0gcmVzcG9uc2UudGV4dCgpO1xuXG4gICAgY29uc29sZS5sb2coYEFJIFJlc3BvbnNlIGZvciAke3N0YWdlfTpgLCB0ZXh0LnN1YnN0cmluZygwLCAxMDApICsgJy4uLicpO1xuXG4gICAgaWYgKCF0ZXh0IHx8IHRleHQudHJpbSgpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgY29uc29sZS5lcnJvcignRW1wdHkgcmVzcG9uc2UgZnJvbSBBSScpO1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgXG4gICAgICAgIGVycm9yOiAnRW1wdHkgcmVzcG9uc2UgZnJvbSBBSScsXG4gICAgICAgIGRldGFpbHM6ICdUaGUgQUkgbW9kZWwgcmV0dXJuZWQgYW4gZW1wdHkgcmVzcG9uc2UnXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAoc3RhZ2UgPT09ICdpbXByb3ZlJykge1xuICAgICAgLy8gU3BsaXQgb24gT3B0aW9uIDE6IGFuZCBPcHRpb24gMjogc3BlY2lmaWNhbGx5XG4gICAgICBjb25zdCBwYXJ0cyA9IHRleHQuc3BsaXQoL09wdGlvbiBbMTJdOi8pO1xuICAgICAgaWYgKHBhcnRzLmxlbmd0aCA8IDMpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignSW52YWxpZCBpbXByb3ZlbWVudCBmb3JtYXQgcmVjZWl2ZWQ6JywgdGV4dCk7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IFxuICAgICAgICAgIGVycm9yOiAnSW52YWxpZCBpbXByb3ZlbWVudCBmb3JtYXQnLFxuICAgICAgICAgIGRldGFpbHM6ICdUaGUgQUkgcmVzcG9uc2UgZGlkIG5vdCBjb250YWluIHByb3Blcmx5IGZvcm1hdHRlZCBvcHRpb25zJ1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgY29uc3Qgb3B0aW9ucyA9IFtwYXJ0c1sxXS50cmltKCksIHBhcnRzWzJdLnRyaW0oKV07XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLmpzb24oeyBvcHRpb25zIH0pO1xuXG4gICAgfSBlbHNlIGlmIChzdGFnZSA9PT0gJ2NyaXRpcXVlJykge1xuICAgICAgY29uc3Qgc2VjdGlvbnMgPSB7fTtcbiAgICAgIGxldCBjdXJyZW50U2VjdGlvbiA9IG51bGw7XG4gICAgICBsZXQgY3VycmVudFN0YXR1cyA9IG51bGw7XG4gICAgICBsZXQgY3VycmVudEZlZWRiYWNrID0gW107XG5cbiAgICAgIC8vIFByb2Nlc3MgQUkgcmVzcG9uc2UgZmlyc3QgdG8gZ2V0IGZlZWRiYWNrXG4gICAgICBjb25zdCBsaW5lcyA9IHRleHQuc3BsaXQoJ1xcbicpO1xuICAgICAgZm9yIChsZXQgbGluZSBvZiBsaW5lcykge1xuICAgICAgICBsaW5lID0gbGluZS50cmltKCk7XG4gICAgICAgIGlmICghbGluZSkgY29udGludWU7XG5cbiAgICAgICAgaWYgKGxpbmUuc3RhcnRzV2l0aCgnIyMgJykpIHtcbiAgICAgICAgICAvLyBTYXZlIHByZXZpb3VzIHNlY3Rpb24gaWYgZXhpc3RzXG4gICAgICAgICAgaWYgKGN1cnJlbnRTZWN0aW9uKSB7XG4gICAgICAgICAgICBjb25zdCBrZXkgPSBjdXJyZW50U2VjdGlvbi50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL1teYS16MC05XSsvZywgJ18nKTtcbiAgICAgICAgICAgIHNlY3Rpb25zW2tleV0gPSB7XG4gICAgICAgICAgICAgIG5hbWU6IGN1cnJlbnRTZWN0aW9uLFxuICAgICAgICAgICAgICBuZWVkc1dvcms6IGN1cnJlbnRTdGF0dXMgPT09ICdZRVMnLFxuICAgICAgICAgICAgICBmZWVkYmFjazogY3VycmVudEZlZWRiYWNrLmpvaW4oJ1xcbicpLnRyaW0oKSxcbiAgICAgICAgICAgICAgY29udGVudDogJycgLy8gV2lsbCBiZSBwb3B1bGF0ZWQgbGF0ZXJcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gU3RhcnQgbmV3IHNlY3Rpb25cbiAgICAgICAgICBjdXJyZW50U2VjdGlvbiA9IGxpbmUucmVwbGFjZSgnIyMgJywgJycpLnRyaW0oKTtcbiAgICAgICAgICBjdXJyZW50U3RhdHVzID0gbnVsbDtcbiAgICAgICAgICBjdXJyZW50RmVlZGJhY2sgPSBbXTtcbiAgICAgICAgfSBlbHNlIGlmIChsaW5lLnN0YXJ0c1dpdGgoJ1N0YXR1czonKSkge1xuICAgICAgICAgIGN1cnJlbnRTdGF0dXMgPSBsaW5lLnJlcGxhY2UoJ1N0YXR1czonLCAnJykudHJpbSgpO1xuICAgICAgICB9IGVsc2UgaWYgKGxpbmUuc3RhcnRzV2l0aCgnRmVlZGJhY2s6JykpIHtcbiAgICAgICAgICBjdXJyZW50RmVlZGJhY2sgPSBbbGluZS5yZXBsYWNlKCdGZWVkYmFjazonLCAnJykudHJpbSgpXTtcbiAgICAgICAgfSBlbHNlIGlmIChjdXJyZW50RmVlZGJhY2spIHtcbiAgICAgICAgICBjdXJyZW50RmVlZGJhY2sucHVzaChsaW5lKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBTYXZlIHRoZSBsYXN0IHNlY3Rpb25cbiAgICAgIGlmIChjdXJyZW50U2VjdGlvbikge1xuICAgICAgICBjb25zdCBrZXkgPSBjdXJyZW50U2VjdGlvbi50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL1teYS16MC05XSsvZywgJ18nKTtcbiAgICAgICAgc2VjdGlvbnNba2V5XSA9IHtcbiAgICAgICAgICBuYW1lOiBjdXJyZW50U2VjdGlvbixcbiAgICAgICAgICBuZWVkc1dvcms6IGN1cnJlbnRTdGF0dXMgPT09ICdZRVMnLFxuICAgICAgICAgIGZlZWRiYWNrOiBjdXJyZW50RmVlZGJhY2suam9pbignXFxuJykudHJpbSgpLFxuICAgICAgICAgIGNvbnRlbnQ6ICcnIC8vIFdpbGwgYmUgcG9wdWxhdGVkIGxhdGVyXG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIC8vIE5vdyBleHRyYWN0IGNvbnRlbnQgZnJvbSB0aGUgZHJhZnRcbiAgICAgIGxldCBjdXJyZW50RHJhZnRTZWN0aW9uID0gbnVsbDtcbiAgICAgIGxldCBjdXJyZW50Q29udGVudCA9IFtdO1xuICAgICAgY29uc3QgZHJhZnRMaW5lcyA9IGNsZWFuRHJhZnQuc3BsaXQoJ1xcbicpO1xuICAgICAgXG4gICAgICBmb3IgKGNvbnN0IGxpbmUgb2YgZHJhZnRMaW5lcykge1xuICAgICAgICBpZiAobGluZS50cmltKCkuc3RhcnRzV2l0aCgnIyMgJykpIHtcbiAgICAgICAgICAvLyBTYXZlIHByZXZpb3VzIHNlY3Rpb24gY29udGVudFxuICAgICAgICAgIGlmIChjdXJyZW50RHJhZnRTZWN0aW9uKSB7XG4gICAgICAgICAgICBjb25zdCBrZXkgPSBjdXJyZW50RHJhZnRTZWN0aW9uLnRvTG93ZXJDYXNlKCkucmVwbGFjZSgvW15hLXowLTldKy9nLCAnXycpO1xuICAgICAgICAgICAgaWYgKHNlY3Rpb25zW2tleV0pIHtcbiAgICAgICAgICAgICAgc2VjdGlvbnNba2V5XS5jb250ZW50ID0gY3VycmVudENvbnRlbnQuam9pbignXFxuJykudHJpbSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBjdXJyZW50RHJhZnRTZWN0aW9uID0gbGluZS5yZXBsYWNlKC9eIyMgLywgJycpLnRyaW0oKTtcbiAgICAgICAgICBjdXJyZW50Q29udGVudCA9IFtdO1xuICAgICAgICB9IGVsc2UgaWYgKGN1cnJlbnREcmFmdFNlY3Rpb24pIHtcbiAgICAgICAgICBjdXJyZW50Q29udGVudC5wdXNoKGxpbmUpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIFNhdmUgdGhlIGxhc3Qgc2VjdGlvbiBjb250ZW50XG4gICAgICBpZiAoY3VycmVudERyYWZ0U2VjdGlvbikge1xuICAgICAgICBjb25zdCBrZXkgPSBjdXJyZW50RHJhZnRTZWN0aW9uLnRvTG93ZXJDYXNlKCkucmVwbGFjZSgvW15hLXowLTldKy9nLCAnXycpO1xuICAgICAgICBpZiAoc2VjdGlvbnNba2V5XSkge1xuICAgICAgICAgIHNlY3Rpb25zW2tleV0uY29udGVudCA9IGN1cnJlbnRDb250ZW50LmpvaW4oJ1xcbicpLnRyaW0oKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAoT2JqZWN0LmtleXMoc2VjdGlvbnMpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gcGFyc2Ugc2VjdGlvbnMgZnJvbSB0ZXh0OicsIHRleHQpO1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBcbiAgICAgICAgICBlcnJvcjogJ0ludmFsaWQgY3JpdGlxdWUgZm9ybWF0JyxcbiAgICAgICAgICBkZXRhaWxzOiAnVGhlIEFJIHJlc3BvbnNlIGRpZCBub3QgY29udGFpbiBwcm9wZXJseSBmb3JtYXR0ZWQgc2VjdGlvbnMnXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLmpzb24oeyBzZWN0aW9ucyB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgZmVlZGJhY2s6IHRleHQgfSk7XG4gICAgfVxuXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignQUkgQVBJIEVycm9yOicsIGVycm9yKTtcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oeyBcbiAgICAgIGVycm9yOiAnRmFpbGVkIHRvIHByb2Nlc3Mgd2l0aCBBSScsXG4gICAgICBkZXRhaWxzOiBlcnJvci5tZXNzYWdlIFxuICAgIH0pO1xuICB9XG59XG4iXSwibmFtZXMiOlsiR29vZ2xlR2VuZXJhdGl2ZUFJIiwiZ2VuQUkiLCJwcm9jZXNzIiwiZW52IiwiR09PR0xFX0FJX0FQSV9LRVkiLCJDUklUSVFVRV9QUk9NUFQiLCJJTVBST1ZFTUVOVF9QUk9NUFQiLCJGSU5BTF9SRVZJRVdfUFJPTVBUIiwiZ2VuZXJhdGlvbkNvbmZpZyIsInRlbXBlcmF0dXJlIiwidG9wUCIsInRvcEsiLCJtYXhPdXRwdXRUb2tlbnMiLCJoYW5kbGVyIiwicmVxIiwicmVzIiwibWV0aG9kIiwic3RhdHVzIiwianNvbiIsImVycm9yIiwiRXJyb3IiLCJkcmFmdCIsInN0YWdlIiwic2VjdGlvbiIsImJvZHkiLCJjbGVhbkRyYWZ0IiwicmVwbGFjZSIsInRyaW0iLCJjb25zb2xlIiwibG9nIiwibGVuZ3RoIiwibW9kZWwiLCJnZXRHZW5lcmF0aXZlTW9kZWwiLCJwcm9tcHQiLCJyZXN1bHQiLCJnZW5lcmF0ZUNvbnRlbnQiLCJyZXNwb25zZSIsInRleHQiLCJzdWJzdHJpbmciLCJkZXRhaWxzIiwicGFydHMiLCJzcGxpdCIsIm9wdGlvbnMiLCJzZWN0aW9ucyIsImN1cnJlbnRTZWN0aW9uIiwiY3VycmVudFN0YXR1cyIsImN1cnJlbnRGZWVkYmFjayIsImxpbmVzIiwibGluZSIsInN0YXJ0c1dpdGgiLCJrZXkiLCJ0b0xvd2VyQ2FzZSIsIm5hbWUiLCJuZWVkc1dvcmsiLCJmZWVkYmFjayIsImpvaW4iLCJjb250ZW50IiwicHVzaCIsImN1cnJlbnREcmFmdFNlY3Rpb24iLCJjdXJyZW50Q29udGVudCIsImRyYWZ0TGluZXMiLCJPYmplY3QiLCJrZXlzIiwibWVzc2FnZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./pages/api/ai.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fai&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fai.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();